<!DOCTYPE HTML>
<html lang="zh-TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Day15|密碼學初探(8)：零知識證明 - 區塊鏈到底在幹嘛 - 30天系列</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">區塊鏈到底在幹嘛 - 30天系列</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="day15密碼學初探8零知識證明"><a class="header" href="#day15密碼學初探8零知識證明">Day15|密碼學初探(8)：零知識證明</a></h1>
<h1 id="沒有隱私的交易"><a class="header" href="#沒有隱私的交易">沒有隱私的交易</a></h1>
<p>打開<a href="https://etherscan.io/address/0x5a0b54d5dc17e0aadc383d2db43b0a0d3e029c4c">Ethereum區塊瀏覽器任意點一個地址</a>，你會發現該錢包地址所有的交易紀錄、收款、匯款的明細通通被攤在陽光下，因為區塊鏈上的帳本人人都可以擁有，舉凡所有的交易、金流全部都公開透明，要了解一個地址的使用情形非常容易：只要點開區塊鏈瀏覽器就可以了。</p>
<p><img src="https://www.lkm543.site/it_iron_man/day16_1.jpg" alt="Etherscan" /><br />
圖片擷取自：<a href="https://etherscan.io/">Etherscan</a></p>
<p>但問題來了，如果這是一間公司的錢包地址，那麼這間公司的所有收入與支出都會攤在對手的眼皮底下，也就是說這間公司的營業額、客單價、消費人數、成本結構等機密資訊都可以輕易地被任何人取得。換算成個人的例子就是：如果你的錢包地址外流，那麼你在何時向誰支付了多少錢、你的戶頭裡還剩多少錢通通可以透過查詢區塊鏈得知。</p>
<p>即使區塊鏈的特色之一就是公開透明、無法竄改，但很明顯的，某些交易或資訊我們還是不希望外界知道。如果不希望外界知道的話，交易明細也必須對礦工保密，但如果連礦工都不知道發起人與收款人是誰、款項多少，那他恐怕也無法幫我們確認餘額是否足夠、是否為本人簽發，這樣不就沒辦法發起交易了嗎？</p>
<p>有沒有辦法在礦工不知道交易細節的狀況下仍然可以讓礦工驗證交易？方法是有的，在沒有任何交易相關資訊的前提下說服礦工這筆交易是合法的，這就是<code>零知識證明</code>。</p>
<h1 id="零知識證明zero-knowledge-proofs"><a class="header" href="#零知識證明zero-knowledge-proofs">零知識證明(Zero-Knowledge Proofs)</a></h1>
<p>零知識證明的定義是：<strong>不提供任何有關訊息的資料，但仍然可以說服對方該筆訊息是正確的。</strong></p>
<p>最普遍的舉例就是如果前面有一個U字型的通道，通道正中間有一道上鎖的鐵門，那你如何在不出示任何有關鑰匙的資訊下說服驗證者你手上有鑰匙？在這裡有個簡單的方法：不論驗證者要你從A出口或B出口出來你都可以做到，便可以說服驗證者你手上有鑰匙了(即便他連鑰匙或開門的動作都沒看到)！</p>
<p><img src="images/day15_25647.png" alt="ZKP Demo" /><br />
圖片來源：<a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof">Wikipedia</a></p>
<p>零知識證明在區塊鏈上的應用就是在沒有出示任何交易明細的情形下，說服礦工我們有權力動用這筆錢並發起匯款，也就是交易的紀錄就被隱藏，藉此保障了隱私。</p>
<h2 id="同態隱藏homomorphic-hidings"><a class="header" href="#同態隱藏homomorphic-hidings">同態隱藏(Homomorphic Hidings)</a></h2>
<p><code>同態隱藏</code>是零知識證明的核心，滿足同態隱藏的函式f(x)有三個定義：</p>
<ol>
<li>透過f(x)很難反推出x</li>
<li>不同的x會導致不同的f(x)</li>
<li>如果知道f(x)與f(y)的值，就可以算出f(x+y)</li>
</ol>
<p>為了幫助理解，我們可以想像成x與y是我們需要保密的兩筆資訊，但同時我們又需要向外界證明我們手上有這兩筆資料。因此我們可以透過滿足同態隱藏的函式f傳遞加密過後的f(x)與f(y)給對方，對方可以計算f(x+y)的值來知道我們手上這兩筆資料的和的確是x+y，但又無法確知x與y的值。最後結果就是我們在沒有洩漏x與y的狀況下說服對方認可我們手上x與y的和的確是x+y。</p>
<p><img src="https://www.lkm543.site/it_iron_man/day16_2.png" alt="Homomorphic Hidings" /></p>
<p>比方說我們現在有兩個數123、321想要隱藏，但又想要說服別人我們手上這兩個數的和是444的話，我們可以透過計算f(123)與f(321)的值給對方後，讓對方透過f(123)與f(321)去計算f(x+y)的值是否為f(444)，如果是的話就可以說服對方了。同時同態隱藏的定義之一便是透過f(x)很難反推x，因此即便我們把f(123)與f(321)給出去，對方也很難反推出123與321的值。另外也因為不同的x會導致不同的f(x)，如果f(x+y)算出來的確是f(444)，就可以肯定x、y的和的確就是444而且沒有其他可能。</p>
<p>但一般的加減乘除無法滿足同態隱藏，因此計算上必須導入取餘數的概念，有興趣看完整推導的話可以參考<a href="https://electriccoin.co/blog/snark-explain/">這裡</a>。</p>
<h2 id="zk-snarks"><a class="header" href="#zk-snarks">zk-SNARKs</a></h2>
<p>第一個利用零知識證明來做到交易匿蹤性的是<a href="https://www.zfnd.org/">ZEC</a>，其中的演算法便是<code>zk-SNARKs</code>，但因為ZEC的新區塊獎勵會有大約20%進入基金會的口袋以支持運作，部分支持者不滿這種行為於是分岔出了<a href="https://zclassic.org/">ZCL</a>，因此兩者的加密法與架構都是一致的。(順帶一提，我覺得ZEC的行為是很合理的、ZCL倒有點小題大作，研究與開發不可能只靠熱情就能持續，還是要有銀彈支撐)</p>
<p>zk-SNARKs是<code>zero knowledge Succinct Non-interactive ARgument of Knowledge</code>的縮寫(<del>實在有夠長</del>)，這幾個詞分別代表了：Succinct(簡潔，用很少的資料量可以完成整個溝通與驗證)、Non-interactive(只需要很少刺或不需要與原始發送者溝通即可驗證訊息)、ARgument(只在計算上是安全的，如果遇到一個計算能力極強的攻擊者會失效)。</p>
<p>想更了解zk-SNARKs可以參考<a href="https://z.cash/technology/zksnarks/">ZEC的官網</a>，或是中文資料對你比較友善的話也可以參考<a href="https://medium.com/taipei-ethereum-meetup/%E6%B7%B1%E5%85%A5%E7%9E%AD%E8%A7%A3-zk-snarks-7a0187f399f1">這裡</a>。<br />
關於零知識證明更多的資料，這裡有一份<a href="https://people.eecs.berkeley.edu/~sanjamg/classes/cs294-spring16/scribes/6.pdf">Berkley的上課講義</a>，有興趣可以參考一下(<del>順便看一下國外頂尖大學是怎麼上課的</del>)。</p>
<h2 id="犯罪者的溫床"><a class="header" href="#犯罪者的溫床">犯罪者的溫床</a></h2>
<p>保障了交易雙方隱私的同時，也往往成為犯罪者洗錢的溫床，為了避免洗錢也有許多國家希望能夠禁止匿蹤幣在交易所的流通(<a href="https://www.forbes.com/sites/adelsteinjake/2018/04/30/japans-financial-regulator-is-pushing-crypto-exchanges-to-drop-altcoins-favored-by-criminals/">資料來源</a>)，雖然你可能會有疑問，之前盛行的勒索軟體為什麼不直接勒索匿蹤貨幣就好？原因是匿蹤幣的流通量都比較小眾，相對使用的門檻也高一點，攻擊者如果要受害者去買一個他不知道要怎麼買、怎麼用的東西往往太強人所難......</p>
<h1 id="幾種匿蹤性貨幣"><a class="header" href="#幾種匿蹤性貨幣">幾種匿蹤性貨幣</a></h1>
<p>接下來我們簡單介紹一下目前幾種主流的匿蹤貨幣：</p>
<h2 id="zec"><a class="header" href="#zec">ZEC</a></h2>
<p>ZEC最有名的就是它的錢包地址也可以分成兩種：<code>透明地址</code>與<code>隱私地址</code>，因此對應到四種交易種類，因為匿蹤需要耗費更多的運算資源與運算時間，因此ZEC透過手續費的機制讓使用者選擇要透明的交易(手續費較少)或是隱私的交易(手續費較多)，這四種交易形式分別如下圖。</p>
<p><img src="images/day15_33464.png" alt="Zec Transaction Type" /><br />
圖片來源：<a href="https://electriccoin.co">electriccoin</a></p>
<p>共區分成：</p>
<ol>
<li>Public: 匯款、收款雙方都是透明的。</li>
<li>Shielding: 收款方式保密的。</li>
<li>Deshielding: 匯款方是保密的。</li>
<li>Private: 匯款、收款雙方都是保密的。</li>
</ol>
<p>你可以到<a href="https://explorer.zcha.in/">ZEC的區塊瀏覽器</a>找找看是否能夠找到我們上面提到的這四種交易(實際上有匿蹤的交易很少，大家為了省手續費基本上都用Public)。</p>
<h2 id="moneroxmr"><a class="header" href="#moneroxmr">Monero(XMR)</a></h2>
<p>XMR主要使用了三個技術來保障隱私：</p>
<ol>
<li>Ring Signature</li>
<li>Ring Confidential Transactions</li>
<li>Stealth Address</li>
</ol>
<p>XMR的有趣之處在於你可以利用私鑰為每一次的收款產出<code>一次性的地址</code>(有點類似劃撥的概念)，透過生成無限多地址的能力，讓外界無從猜測那些地址是屬於那些人的。<a href="https://moneroblocks.info/">XMR的區塊瀏覽器</a>在此，對相關技術細節有興趣的話可以參考<a href="https://medium.com/taipei-ethereum-meetup/monero-%E9%96%80%E7%BE%85%E5%B9%A3-%E9%9A%B1%E5%8C%BF%E4%BA%A4%E6%98%93%E7%9A%84%E5%9F%BA%E7%A4%8E%E4%BB%8B%E7%B4%B9-423451f4e8b4">這裡</a></p>
<h2 id="dash"><a class="header" href="#dash">Dash</a></h2>
<p>Dash的匿蹤性是靠著把要發送給別人的錢通通參在一起，比方說現在A要匯款給B、C要匯款給D，為了隱私就先把AB要匯的錢<code>混在一起(mix)</code>再從中撥款給C與D，於是外界就區分不出來A或C的款項原本是要匯給誰了！</p>
<p>你可能會有疑問，那如果A與B的金額不一樣，那不就穿幫了嗎。事實不然，Dash會把交易金額切割承夠細夠小的單位，在讓這些小單位的Dash去做混合(mix)，而這些負責混合的節點又稱為master node。順帶一提，你可以到<a href="https://docs.dash.org/en/stable/masternodes/setup.html">Dash的官方文件</a>上看看怎麼成為Dash的master node，並賺取每年大概6%的Dash，但在成為master node前你要先準備1000 Dash(以現在幣值計算需要快三百萬台幣....)</p>
<p><img src="https://www.lkm543.site/it_iron_man/day16_3.png" alt="Dash" /></p>
<p>下面這張表格是各種匿蹤幣的比較，你也可以發現因為Dash有master node的機制，在分類上並不是去中心化(decentralized)的。</p>
<p><img src="images/day15_18921.jpg" alt="Comparison" /><br />
圖片來源：<a href="https://masterthecrypto.com">masterthecrypto</a></p>
<p>到目前為止的文章都會放置在<a href="https://github.com/lkm543/it_iron_man_2019">Github</a>上。</p>
<h1 id="ref"><a class="header" href="#ref">Ref:</a></h1>
<ul>
<li><a href="https://blocktrend.today/07-17-2018-zero-knowledge-proof-intro">看懂零知識證明（zero-knowledge proofs）</a></li>
<li><a href="https://en.wikipedia.org/wiki/Zero-knowledge_proof">Wikipedia-Zero-knowledge proof</a></li>
<li><a href="https://electriccoin.co/blog/snark-explain/">Explaining SNARKs Part I: Homomorphic Hidings</a></li>
<li><a href="https://hackmd.io/4DLJ4mikRni08g5s9OukKg">認識零知識證明 - 吳偉誠</a></li>
<li><a href="https://electriccoin.co/blog/anatomy-of-zcash/">Anatomy of A Zcash Transaction</a></li>
<li><a href="https://medium.com/taipei-ethereum-meetup/%E6%B7%B1%E5%85%A5%E7%9E%AD%E8%A7%A3-zk-snarks-7a0187f399f1">深入瞭解 zk-SNARKs</a></li>
<li><a href="https://www.chainnews.com/articles/931561645479.htm">零知识证明 | 1. 什么是同态隐藏？</a></li>
<li><a href="https://itw01.com/KY5EWNK.html">區塊鏈解讀-零知識證明（－zero-knowledge proof）</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="day14.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="day16.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="day14.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="day16.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
